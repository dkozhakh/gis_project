/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var l7Raw = ee.ImageCollection("LANDSAT/LE7_L1T"),
    BU_training = /* color: #d6d150 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[37.59815454483032, 55.74997758060833],
                  [37.5981330871582, 55.74981454764531],
                  [37.598369121551514, 55.74979643282958],
                  [37.59848713874817, 55.750031924777936],
                  [37.598122358322144, 55.75005607771791]]]),
            {
              "landcover": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.60178089141846, 55.75009834532687],
                  [37.60153412818909, 55.74976624145133],
                  [37.60174870491028, 55.749717935197545],
                  [37.60194182395935, 55.750007771823014]]]),
            {
              "landcover": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.59742498397827, 55.74987493030365],
                  [37.59739279747009, 55.749711896911634],
                  [37.59800434112549, 55.74972397348254],
                  [37.59793996810913, 55.74987493030365]]]),
            {
              "landcover": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.606834173202515, 55.74933148301394],
                  [37.6067054271698, 55.749150332235054],
                  [37.607338428497314, 55.7489631422132],
                  [37.607585191726685, 55.749174485720836]]]),
            {
              "landcover": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.614827156066895, 55.750376102760775],
                  [37.61495590209961, 55.74955490114942],
                  [37.61637210845947, 55.749820585915344],
                  [37.616329193115234, 55.750351950018946]]]),
            {
              "landcover": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.55478858947754, 55.73996488528175],
                  [37.555389404296875, 55.738370346837335],
                  [37.563629150390625, 55.74025479436318],
                  [37.563114166259766, 55.741414409152696]]]),
            {
              "landcover": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.53955364227295, 55.736316678616994],
                  [37.54019737243652, 55.735809285116005],
                  [37.5408411026001, 55.73595425536076],
                  [37.539939880371094, 55.73643748562124]]]),
            {
              "landcover": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65869736671448, 55.69303164413583],
                  [37.65837550163269, 55.69282604367479],
                  [37.65863299369812, 55.69266277195015],
                  [37.6592230796814, 55.693025597078886],
                  [37.65885829925537, 55.693049785301085]]]),
            {
              "landcover": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.660778760910034, 55.69199758380199],
                  [37.660542726516724, 55.69179197790281],
                  [37.66085386276245, 55.6916589382154],
                  [37.66115427017212, 55.69186454481422]]]),
            {
              "landcover": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65841841697693, 55.69073369513991],
                  [37.6581072807312, 55.69055831980097],
                  [37.65835404396057, 55.69035270633281],
                  [37.658772468566895, 55.69058250954966]]]),
            {
              "landcover": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.63537287712097, 55.76480714453963],
                  [37.63520121574402, 55.764650209530984],
                  [37.63594150543213, 55.764414805833596],
                  [37.635737657547, 55.76423372509926],
                  [37.63508319854736, 55.76435444568225],
                  [37.63489007949829, 55.76424579717439],
                  [37.63550162315369, 55.76394399417507],
                  [37.63586640357971, 55.7638896693871],
                  [37.636510133743286, 55.76447516589147]]]),
            {
              "landcover": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.63692855834961, 55.764396697798],
                  [37.63638138771057, 55.76378101958408],
                  [37.637507915496826, 55.76341281522242],
                  [37.6382052898407, 55.764040571388996],
                  [37.63711094856262, 55.76455363382705]]]),
            {
              "landcover": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.63543725013733, 55.761964108571895],
                  [37.63473987579346, 55.76232629028055],
                  [37.6322078704834, 55.76099827423569],
                  [37.63292670249939, 55.760672299747895],
                  [37.63317346572876, 55.7607869947858],
                  [37.63259410858154, 55.76100431077458],
                  [37.63465404510498, 55.762096908922366],
                  [37.6352334022522, 55.761843380588125]]]),
            {
              "landcover": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61288523674011, 55.755631421471804],
                  [37.61215567588806, 55.755866878196215],
                  [37.611833810806274, 55.75580650481265],
                  [37.611340284347534, 55.7554382251491],
                  [37.611072063446045, 55.75508201692033],
                  [37.61198401451111, 55.75473788045719],
                  [37.61220932006836, 55.75494919268034],
                  [37.61199474334717, 55.75504579217248],
                  [37.61190891265869, 55.75493108024894],
                  [37.611565589904785, 55.75505786709218],
                  [37.61223077774048, 55.75569783248673],
                  [37.612584829330444, 55.75558312248085],
                  [37.61250972747803, 55.755480486926466],
                  [37.61269211769104, 55.755432187748596]]]),
            {
              "landcover": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61372208595276, 55.755492561711584],
                  [37.61446237564087, 55.75534162662888],
                  [37.616039514541626, 55.75589706485296],
                  [37.61519193649292, 55.75661550038849]]]),
            {
              "landcover": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61735916137695, 55.755776318085836],
                  [37.6167368888855, 55.7554382251491],
                  [37.61795997619629, 55.75476806798773],
                  [37.61863589286804, 55.75506390455061]]]),
            {
              "landcover": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61823892593384, 55.75451449200507],
                  [37.6191508769989, 55.753965071720465],
                  [37.62138247489929, 55.7531680966737],
                  [37.62214422225952, 55.753572623921855],
                  [37.61912941932678, 55.75506390455061]]]),
            {
              "landcover": 1,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.62448310852051, 55.75421261368574],
                  [37.625834941864014, 55.752703187043075],
                  [37.627562284469604, 55.75292054807959],
                  [37.627315521240234, 55.75341564369682],
                  [37.62569546699524, 55.75459901751578]]]),
            {
              "landcover": 1,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.62411832809448, 55.751205778101635],
                  [37.62290596961975, 55.75128427273987],
                  [37.62343168258667, 55.74993776590825],
                  [37.62465476989746, 55.74972038825092],
                  [37.62523412704468, 55.75019740985593],
                  [37.6252019405365, 55.75139295736281]]]),
            {
              "landcover": 1,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.62092113494873, 55.748017554695544],
                  [37.62072801589966, 55.74816247959386],
                  [37.61946201324463, 55.74790282210259],
                  [37.61996626853943, 55.747063452343376],
                  [37.6202666759491, 55.74709968450447],
                  [37.61996626853943, 55.7477639348281]]]),
            {
              "landcover": 1,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61564254760742, 55.744557312885156],
                  [37.61535286903381, 55.744364061712076],
                  [37.615588903427124, 55.74423724010956],
                  [37.61593222618103, 55.7443338661298]]]),
            {
              "landcover": 1,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.61151194572449, 55.74519745055983],
                  [37.61070728302002, 55.74456335196891],
                  [37.61142611503601, 55.74408022231631],
                  [37.61276721954346, 55.74467205531636],
                  [37.61235952377319, 55.74518537258772]]]),
            {
              "landcover": 1,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.6377010345459, 55.740583393133434],
                  [37.63539433479309, 55.740118333520876],
                  [37.635737657547, 55.73969554724569],
                  [37.63671398162842, 55.73962910898601],
                  [37.638291120529175, 55.739906940955805]]]),
            {
              "landcover": 1,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.64036178588867, 55.740885376927054],
                  [37.64097332954407, 55.739737826079306],
                  [37.64261484146118, 55.74009417442852],
                  [37.642024755477905, 55.741084684950756]]]),
            {
              "landcover": 1,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.63958930969238, 55.7415316143942],
                  [37.63990044593811, 55.74090953552961],
                  [37.64042615890503, 55.74098805088458],
                  [37.640050649642944, 55.741634286651475]]]),
            {
              "landcover": 1,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65321493148804, 55.73936335481629],
                  [37.653751373291016, 55.738560041437154],
                  [37.654030323028564, 55.73860836150628],
                  [37.653504610061646, 55.73936335481629]]]),
            {
              "landcover": 1,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65759229660034, 55.737539265996034],
                  [37.65660524368286, 55.737116451780985],
                  [37.65689492225647, 55.73677215682245],
                  [37.65766739845276, 55.73730369864129]]]),
            {
              "landcover": 1,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.66312837600708, 55.73757550700135],
                  [37.66458749771118, 55.736699673286275],
                  [37.665778398513794, 55.73725537695688],
                  [37.66544580459595, 55.737345980066074],
                  [37.664780616760254, 55.737068129864745],
                  [37.66356825828552, 55.73780503258681]]]),
            {
              "landcover": 1,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.67289161682129, 55.737798992457115],
                  [37.67263412475586, 55.73738826144505],
                  [37.67285943031311, 55.73735202026587],
                  [37.67309546470642, 55.73771443054328]]]),
            {
              "landcover": 1,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.67386794090271, 55.73887412081713],
                  [37.67381429672241, 55.73852380134605],
                  [37.6746940612793, 55.738354680475936],
                  [37.67495155334473, 55.73888620074281]]]),
            {
              "landcover": 1,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.67189383506775, 55.74031160572117],
                  [37.67194747924805, 55.739973378742505],
                  [37.67309546470642, 55.739870702115404],
                  [37.67356753349304, 55.740184770947685],
                  [37.67340660095215, 55.740269327509154],
                  [37.67314910888672, 55.740106253976556],
                  [37.67245173454285, 55.74017269142395],
                  [37.672226428985596, 55.74041428118826]]]),
            {
              "landcover": 1,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.67736554145813, 55.74308978782729],
                  [37.676968574523926, 55.74258852176699],
                  [37.679715156555176, 55.74172487959529],
                  [37.68014430999756, 55.742220117304164]]]),
            {
              "landcover": 1,
              "system:index": "31"
            })]),
    NBU_training = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65612244606018, 55.69034061138924],
                  [37.65632629394531, 55.690147091783395],
                  [37.65672326087952, 55.6903587538032],
                  [37.656540870666504, 55.69047970301434]]]),
            {
              "landcover": 0,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65313982963562, 55.691308195051285],
                  [37.65359044075012, 55.69113282228928],
                  [37.65390157699585, 55.69154403993921],
                  [37.65333294868469, 55.69167103275116]]]),
            {
              "landcover": 0,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65081167221069, 55.691755694396605],
                  [37.65117645263672, 55.69147751973028],
                  [37.6517128944397, 55.6916589382154],
                  [37.65118718147278, 55.69190082821942]]]),
            {
              "landcover": 0,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.6116943359375, 55.69988840480335],
                  [37.61152267456055, 55.69938053785179],
                  [37.61263847351074, 55.699259616176356],
                  [37.612810134887695, 55.69984003680658]]]),
            {
              "landcover": 0,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.60890483856201, 55.70341910689962],
                  [37.60886192321777, 55.702282545832226],
                  [37.60963439941406, 55.702282545832226],
                  [37.61002063751221, 55.703274015837906]]]),
            {
              "landcover": 0,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.603111267089844, 55.70044463246421],
                  [37.603111267089844, 55.699791668749924],
                  [37.60439872741699, 55.700226979104876],
                  [37.60401248931885, 55.70063810109943]]]),
            {
              "landcover": 0,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.43968963623047, 55.76097771226808],
                  [37.439002990722656, 55.759287443724986],
                  [37.4399471282959, 55.759287443724986],
                  [37.440547943115234, 55.76083283497797]]]),
            {
              "landcover": 0,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.46355056762695, 55.75571349188569],
                  [37.46355056762695, 55.75363658563527],
                  [37.466468811035156, 55.75363658563527],
                  [37.46664047241211, 55.755230500300925]]]),
            {
              "landcover": 0,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.425549030303955, 55.78220848684712],
                  [37.425785064697266, 55.7816051566201],
                  [37.42720127105713, 55.781737890071575],
                  [37.4268364906311, 55.78244981632216]]]),
            {
              "landcover": 0,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.446770668029785, 55.786241509450626],
                  [37.446797490119934, 55.785921778692014],
                  [37.44732320308685, 55.78592781137214],
                  [37.447280287742615, 55.786262623653634],
                  [37.446808218955994, 55.786247542081206]]]),
            {
              "landcover": 0,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.67889976501465, 55.74133834823598],
                  [37.67881393432617, 55.74105448683078],
                  [37.67910361289978, 55.740975971609494],
                  [37.67932891845703, 55.74116319995331]]]),
            {
              "landcover": 0,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.689199447631836, 55.740837059677126],
                  [37.68961787223816, 55.74022100949645],
                  [37.690218687057495, 55.740372003087465],
                  [37.68980026245117, 55.74098201124749]]]),
            {
              "landcover": 0,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.686946392059326, 55.73927879629185],
                  [37.68666744232178, 55.73898284001362],
                  [37.68716096878052, 55.73866876150858],
                  [37.68765449523926, 55.73887412081713],
                  [37.68716096878052, 55.739176117837324]]]),
            {
              "landcover": 0,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.69690275192261, 55.73730369864129],
                  [37.69680619239807, 55.737025848138984],
                  [37.6971173286438, 55.7369594053345],
                  [37.69741773605347, 55.7371224920163]]]),
            {
              "landcover": 0,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.703715562820435, 55.7394479131575],
                  [37.703425884246826, 55.73891036058295],
                  [37.70365118980408, 55.73866876150858],
                  [37.70402669906616, 55.73911571862023]]]),
            {
              "landcover": 0,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.704209089279175, 55.74034180441601],
                  [37.70425200462341, 55.74011229374919],
                  [37.704466581344604, 55.7401243732916],
                  [37.704423666000366, 55.74036596335506]]]),
            {
              "landcover": 0,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.701687812805176, 55.743077709202744],
                  [37.701677083969116, 55.74208120980053],
                  [37.70328640937805, 55.74159804941503],
                  [37.704187631607056, 55.742528127831086],
                  [37.703683376312256, 55.74302939466723],
                  [37.70226716995239, 55.74311998437229]]]),
            {
              "landcover": 0,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.696484327316284, 55.74460562552891],
                  [37.69681692123413, 55.74408022231631],
                  [37.697235345840454, 55.74450296108947],
                  [37.69691348075867, 55.74482303168541]]]),
            {
              "landcover": 0,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65820384025574, 55.74444257011657],
                  [37.65845060348511, 55.74415269214556],
                  [37.6587188243866, 55.74422516184019],
                  [37.658525705337524, 55.744376139938424]]]),
            {
              "landcover": 0,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65290379524231, 55.745994588454046],
                  [37.652796506881714, 55.745716799824514],
                  [37.65307545661926, 55.745596021542646],
                  [37.653236389160156, 55.74586173326929]]]),
            {
              "landcover": 0,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65792489051819, 55.748180595168314],
                  [37.65792489051819, 55.74796924627648],
                  [37.658482789993286, 55.74798132338687],
                  [37.65846133232117, 55.748102094284995]]]),
            {
              "landcover": 0,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65194892883301, 55.74972038825092],
                  [37.651991844177246, 55.74957546913983],
                  [37.65293598175049, 55.749660005353384],
                  [37.65289306640625, 55.749786809330296]]]),
            {
              "landcover": 0,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65669107437134, 55.75035440303245],
                  [37.65671253204346, 55.75023967731176],
                  [37.657506465911865, 55.75040270849812],
                  [37.6580536365509, 55.75040874667712],
                  [37.65815019607544, 55.75052347190063],
                  [37.65758156776428, 55.75052347190063]]]),
            {
              "landcover": 0,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65713095664978, 55.75081146280284],
                  [37.65716314315796, 55.75074051487294],
                  [37.657544016838074, 55.750785800800536],
                  [37.657538652420044, 55.75085674864809]]]),
            {
              "landcover": 0,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.65718191862106, 55.75135639898395],
                  [37.65717655420303, 55.7511405387479],
                  [37.65766739845276, 55.75112242454787],
                  [37.65766203403473, 55.75133073734011]]]),
            {
              "landcover": 0,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.549638748168945, 55.70972286891198],
                  [37.54843711853027, 55.70828425750125],
                  [37.55225658416748, 55.707111568677625],
                  [37.55399465560913, 55.7087920087535]]]),
            {
              "landcover": 0,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.543909549713135, 55.705963024890394],
                  [37.54221439361572, 55.70535851460028],
                  [37.54369497299194, 55.70391974249468],
                  [37.5457763671875, 55.70526179208601]]]),
            {
              "landcover": 0,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54081964492798, 55.70702694028755],
                  [37.53929615020752, 55.706192736348605],
                  [37.540154457092285, 55.705382695191425],
                  [37.54159212112427, 55.706567525828774]]]),
            {
              "landcover": 0,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.53251552581787, 55.70682141343422],
                  [37.53182888031006, 55.70599929521041],
                  [37.53335237503052, 55.70531015337304],
                  [37.5347900390625, 55.70620482638795]]]),
            {
              "landcover": 0,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.523674964904785, 55.70697858112518],
                  [37.52474784851074, 55.706241096483524],
                  [37.52511262893677, 55.706386176529186],
                  [37.523910999298096, 55.70705111984626]]]),
            {
              "landcover": 0,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.51779556274414, 55.70922721886083],
                  [37.517409324645996, 55.7090700602146],
                  [37.5178599357605, 55.7087920087535],
                  [37.51833200454712, 55.70896125770461]]]),
            {
              "landcover": 0,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.52281665802002, 55.71230981833966],
                  [37.51908302307129, 55.7103877554471],
                  [37.519962787628174, 55.709505267224785],
                  [37.52457618713379, 55.71122186982584]]]),
            {
              "landcover": 0,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.5057578086853, 55.720432209618146],
                  [37.50378370285034, 55.718993992559014],
                  [37.5058650970459, 55.717737019995106],
                  [37.509212493896484, 55.71898190647698]]]),
            {
              "landcover": 0,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.521679401397705, 55.724879470104],
                  [37.52037048339844, 55.72402147829977],
                  [37.52084255218506, 55.72329640010591],
                  [37.521936893463135, 55.72384021001346]]]),
            {
              "landcover": 0,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.519426345825195, 55.72674040162124],
                  [37.51955509185791, 55.724927807109474],
                  [37.52135753631592, 55.72529033274327]]]),
            {
              "landcover": 0,
              "system:index": "34"
            })]),
    BU_validation = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[37.515435218811035, 55.72732041409416],
                  [37.51434087753296, 55.72648664345498],
                  [37.514426708221436, 55.72591870253546],
                  [37.51537084579468, 55.72579786297615],
                  [37.516915798187256, 55.72646247592457]]]),
            {
              "landcover": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.508225440979004, 55.72659539715674],
                  [37.509212493896484, 55.72612412892805],
                  [37.5112509727478, 55.72694582369079],
                  [37.5102424621582, 55.72753791655016]]]),
            {
              "landcover": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.528663873672485, 55.723747120868616],
                  [37.52774119377136, 55.72339666562706],
                  [37.52703309059143, 55.723777332380116],
                  [37.52683997154236, 55.723728993950495],
                  [37.52799868583679, 55.7230764192941],
                  [37.528663873672485, 55.7234268774097]]]),
            {
              "landcover": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.52509117126465, 55.72308850410905],
                  [37.52549886703491, 55.72248425877952],
                  [37.5257134437561, 55.72253864124207],
                  [37.52527356147766, 55.72311267372775]]]),
            {
              "landcover": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.53178596496582, 55.72282867976314],
                  [37.53305196762085, 55.7221156645374],
                  [37.53357768058777, 55.72241174871169],
                  [37.5323760509491, 55.72313080093197]]]),
            {
              "landcover": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.528159618377686, 55.720441840357445],
                  [37.52847075462341, 55.7202726411411],
                  [37.529919147491455, 55.720737937222175],
                  [37.52952218055725, 55.72113071531335]]]),
            {
              "landcover": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.535905838012695, 55.72170476849455],
                  [37.536442279815674, 55.72171685373399],
                  [37.536431550979614, 55.72139659362526],
                  [37.53599166870117, 55.721378465616056],
                  [37.53606677055359, 55.72124552662465],
                  [37.53674268722534, 55.72127574007151],
                  [37.5367534160614, 55.721886046693434],
                  [37.53586292266846, 55.721892089285596]]]),
            {
              "landcover": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.544633746147156, 55.72095727028273],
                  [37.54453718662262, 55.72079411606147],
                  [37.5447678565979, 55.72068534620193],
                  [37.54505217075348, 55.72072462424173],
                  [37.5450736284256, 55.720917992476956],
                  [37.544891238212585, 55.72100561214332]]]),
            {
              "landcover": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54282057285309, 55.72113250924268],
                  [37.54280984401703, 55.720824329857564],
                  [37.542884945869446, 55.72083339399183],
                  [37.542890310287476, 55.72111438111087]]]),
            {
              "landcover": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54234582185745, 55.72111074604175],
                  [37.54234313964844, 55.7209188894465],
                  [37.54241555929184, 55.72091284670379],
                  [37.542402148246765, 55.72111829943173]]]),
            {
              "landcover": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54619747400284, 55.721276920283806],
                  [37.54597753286362, 55.72121045067185],
                  [37.54610896110535, 55.72113189553002],
                  [37.54625380039215, 55.72121498269441]]]),
            {
              "landcover": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54681438207626, 55.721651565071774],
                  [37.54715234041214, 55.72137964582524],
                  [37.54764586687088, 55.72162588389056],
                  [37.547248899936676, 55.72178903463697]]]),
            {
              "landcover": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.55573272705078, 55.72170476849455],
                  [37.55698800086975, 55.72133012421698],
                  [37.557170391082764, 55.721596001171335],
                  [37.55593657493591, 55.7219162596448]]]),
            {
              "landcover": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.559734582901, 55.721227398545295],
                  [37.559369802474976, 55.72081649315644],
                  [37.56057143211365, 55.72041162626543],
                  [37.560914754867554, 55.720919219908986]]]),
            {
              "landcover": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.5517737865448, 55.715788594803676],
                  [37.55176305770874, 55.715444111730974],
                  [37.55275011062622, 55.71456778144861],
                  [37.55397319793701, 55.71424141894006],
                  [37.555646896362305, 55.71453151908232],
                  [37.55626916885376, 55.715425980958784],
                  [37.5551962852478, 55.71654402950239],
                  [37.55353331565857, 55.71691871969252],
                  [37.551881074905396, 55.71641107405484],
                  [37.55184888839722, 55.71579463833924]]]),
            {
              "landcover": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.56556034088135, 55.71261560952453],
                  [37.5657320022583, 55.712295274783294],
                  [37.566343545913696, 55.71211395206747],
                  [37.566858530044556, 55.712192525347646],
                  [37.56721258163452, 55.71246450855878],
                  [37.56701946258545, 55.7128331938885],
                  [37.56656885147095, 55.71305682099973],
                  [37.56608605384827, 55.712905721740505],
                  [37.56572127342224, 55.71273044586764]]]),
            {
              "landcover": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.83189296722412, 55.805769706930974],
                  [37.83186078071594, 55.805208949459384],
                  [37.83312678337097, 55.805184830677305],
                  [37.83316969871521, 55.80580588455499]]]),
            {
              "landcover": 1,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.83211827278137, 55.80450346890926],
                  [37.83211827278137, 55.804015051808655],
                  [37.833802700042725, 55.803954752976225],
                  [37.83441424369812, 55.80396681275019],
                  [37.83436059951782, 55.804563766891825]]]),
            {
              "landcover": 1,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.82760143280029, 55.805015998784164],
                  [37.82747268676758, 55.80468436257676],
                  [37.828330993652344, 55.80466024346968],
                  [37.82821297645569, 55.80505217710862]]]),
            {
              "landcover": 1,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.82426476478577, 55.80636663342825],
                  [37.82451152801514, 55.805793825350726],
                  [37.82466173171997, 55.80581794375555],
                  [37.82444715499878, 55.80639678098835]]]),
            {
              "landcover": 1,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.820316553115845, 55.805697351582076],
                  [37.82075643539429, 55.80566720348032],
                  [37.821067571640015, 55.80561293683837],
                  [37.82097101211548, 55.80555867012077],
                  [37.82117486000061, 55.80547425507634],
                  [37.82136797904968, 55.80565514423311],
                  [37.820584774017334, 55.80593250597433]]]),
            {
              "landcover": 1,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.81743049621582, 55.804298455070004],
                  [37.818310260772705, 55.804370813018906],
                  [37.81794548034668, 55.804587886058705],
                  [37.817065715789795, 55.804551707302785]]]),
            {
              "landcover": 1,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.798118591308594, 55.79834655333696],
                  [37.79819369316101, 55.79818975335262],
                  [37.79874086380005, 55.79820784569073],
                  [37.79867649078369, 55.79813547628788],
                  [37.79892325401306, 55.79813547628788],
                  [37.7989661693573, 55.79830433801867]]]),
            {
              "landcover": 1,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.7990198135376, 55.79455302274232],
                  [37.79914855957031, 55.79396797798212],
                  [37.79967427253723, 55.79393782079756],
                  [37.79971718788147, 55.794565085428395]]]),
            {
              "landcover": 1,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.771586179733276, 55.79432383099672],
                  [37.771629095077515, 55.79407051223505],
                  [37.77147889137268, 55.7936664050855],
                  [37.77220845222473, 55.79329245145068],
                  [37.773109674453735, 55.79338292443354],
                  [37.772347927093506, 55.79381719182571],
                  [37.77228355407715, 55.79404035512986],
                  [37.7734100818634, 55.79420923461814],
                  [37.773088216781616, 55.79460127346426]]]),
            {
              "landcover": 1,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.76999831199646, 55.79532502712006],
                  [37.7699339389801, 55.79471586868931],
                  [37.77052402496338, 55.79475808789773],
                  [37.770406007766724, 55.79533708956704]]]),
            {
              "landcover": 1,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.85322189331055, 55.777027084164516],
                  [37.851505279541016, 55.77668917546115],
                  [37.85287857055664, 55.77543406034014],
                  [37.854251861572266, 55.77572370587877]]]),
            {
              "landcover": 1,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.856998443603516, 55.770026948490404],
                  [37.855024337768555, 55.76910959616956],
                  [37.85545349121094, 55.76853020463374],
                  [37.85785675048828, 55.7694958524095]]]),
            {
              "landcover": 1,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.86669731140137, 55.766985118438946],
                  [37.86789894104004, 55.765198536190084],
                  [37.86918640136719, 55.76582626360661],
                  [37.86815643310547, 55.76727482676491]]]),
            {
              "landcover": 1,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.75893688201904, 55.72347049562963],
                  [37.756147384643555, 55.72112599444626],
                  [37.75717735290527, 55.72049754752832],
                  [37.76009559631348, 55.722745407205075]]]),
            {
              "landcover": 1,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.761597633361816, 55.72105348185649],
                  [37.76031017303467, 55.72001411994067],
                  [37.761125564575195, 55.71965154532298],
                  [37.762370109558105, 55.72052171875062]]]),
            {
              "landcover": 1,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.75473117828369, 55.718660490860465],
                  [37.75571823120117, 55.71716177536864],
                  [37.756662368774414, 55.71745185382292],
                  [37.75730609893799, 55.718418766445026],
                  [37.75498867034912, 55.718998902528774]]]),
            {
              "landcover": 1,
              "system:index": "31"
            })]),
    NBU_validation = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[37.769622802734375, 55.71279334128748],
                  [37.76880741119385, 55.71263619698589],
                  [37.769107818603516, 55.71218893666763],
                  [37.76994466781616, 55.71247905205214]]]),
            {
              "landcover": 0,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.770137786865234, 55.715924007548125],
                  [37.76947259902954, 55.715597656370555],
                  [37.77000904083252, 55.71550095920171],
                  [37.77052402496338, 55.715742701675]]]),
            {
              "landcover": 0,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.76243448257446, 55.712950484956984],
                  [37.76275634765625, 55.712877957188084],
                  [37.762885093688965, 55.71333729745037]]]),
            {
              "landcover": 0,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.744131088256836, 55.714122998536226],
                  [37.74507522583008, 55.71221311303195],
                  [37.74606227874756, 55.7123339946292],
                  [37.7450966835022, 55.71419552399363]]]),
            {
              "landcover": 0,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.73797273635864, 55.71716895181472],
                  [37.73730754852295, 55.71679426402501],
                  [37.737672328948975, 55.716431659515955],
                  [37.738659381866455, 55.71675800372558]]]),
            {
              "landcover": 0,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.69632339477539, 55.69620319660698],
                  [37.69632339477539, 55.69475199385228],
                  [37.7021598815918, 55.69475199385228],
                  [37.7025032043457, 55.69697714938124]]]),
            {
              "landcover": 0,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.70112991333008, 55.69117213004571],
                  [37.70524978637695, 55.69039806233787],
                  [37.70576477050781, 55.69136564457813],
                  [37.70078659057617, 55.6924299573857]]]),
            {
              "landcover": 0,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.66958713531494, 55.69803601892826],
                  [37.66945838928223, 55.69602860162649],
                  [37.67241954803467, 55.695496497828486],
                  [37.672977447509766, 55.69641558165752]]]),
            {
              "landcover": 0,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.661991119384766, 55.69975312541195],
                  [37.663493156433105, 55.699511283992415],
                  [37.66495227813721, 55.69980149351629],
                  [37.66508102416992, 55.70074465958715]]]),
            {
              "landcover": 0,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.776145935058594, 55.84587060477638],
                  [37.769622802734375, 55.835171584364694],
                  [37.78318405151367, 55.82823010486692],
                  [37.797088623046875, 55.8407624307817]]]),
            {
              "landcover": 0,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.69804000854492, 55.845388730243315],
                  [37.69237518310547, 55.84047326878524],
                  [37.702674865722656, 55.83411116073295],
                  [37.71160125732422, 55.84018410463811]]]),
            {
              "landcover": 0,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.69160270690918, 55.88993158569471],
                  [37.691731452941895, 55.88916145773978],
                  [37.694735527038574, 55.890148181428415],
                  [37.69456386566162, 55.89070169836666]]]),
            {
              "landcover": 0,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.692203521728516, 55.89221781302769],
                  [37.69233226776123, 55.89118301102579],
                  [37.69529342651367, 55.89168838289287],
                  [37.69533634185791, 55.89236220181081]]]),
            {
              "landcover": 0,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.472476959228516, 55.839027426543005],
                  [37.46870040893555, 55.83690676066155],
                  [37.47367858886719, 55.8328578955232],
                  [37.4769401550293, 55.834014757150726]]]),
            {
              "landcover": 0,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.527408599853516, 55.81802728630931],
                  [37.52758026123047, 55.81701461816135],
                  [37.528138160705566, 55.816966395211246],
                  [37.52822399139404, 55.81778617723588]]]),
            {
              "landcover": 0,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.54075527191162, 55.818557721012056],
                  [37.54298686981201, 55.81416936185428],
                  [37.55251407623291, 55.81530266683661],
                  [37.55058288574219, 55.8192810294084]]]),
            {
              "landcover": 0,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.64797925949097, 55.754776558226474],
                  [37.647271156311035, 55.75365356660351],
                  [37.647528648376465, 55.75349658670422],
                  [37.648258209228516, 55.754595432732216],
                  [37.64864444732666, 55.75530785482418],
                  [37.64860153198242, 55.755887442858665],
                  [37.64815092086792, 55.755839144184776]]]),
            {
              "landcover": 0,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.647013664245605, 55.75785556294338],
                  [37.64660596847534, 55.75769859995548],
                  [37.648000717163086, 55.75609271155559],
                  [37.64836549758911, 55.756225531901414]]]),
            {
              "landcover": 0,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.64441728591919, 55.76169492238314],
                  [37.645747661590576, 55.760668715522506],
                  [37.6456618309021, 55.76097054387316],
                  [37.64463186264038, 55.76194845168259]]]),
            {
              "landcover": 0,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.64392375946045, 55.76156212066367],
                  [37.64422416687012, 55.761127493692236],
                  [37.644524574279785, 55.76092225149404],
                  [37.645039558410645, 55.76097054387316],
                  [37.64418125152588, 55.761586266464484]]]),
            {
              "landcover": 0,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.640748023986816, 55.76403698747325],
                  [37.64042615890503, 55.763831760588815],
                  [37.642035484313965, 55.76281768248081],
                  [37.64270067214966, 55.76303498715276],
                  [37.6411771774292, 55.763928338080724]]]),
            {
              "landcover": 0,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.63340950012207, 55.7667169099837],
                  [37.63334512710571, 55.76649962583163],
                  [37.63471841812134, 55.76628234046858],
                  [37.634782791137695, 55.766511697205175]]]),
            {
              "landcover": 0,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.612102031707764, 55.76802058946576],
                  [37.61017084121704, 55.76757396344135],
                  [37.6102352142334, 55.76678933776528],
                  [37.6122522354126, 55.76759810551945],
                  [37.612080574035645, 55.76793609304278]]]),
            {
              "landcover": 0,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.59197473526001, 55.764375005869304],
                  [37.59113788604736, 55.76402491533346],
                  [37.5921893119812, 55.7633971589148],
                  [37.59276866912842, 55.76385590498421]]]),
            {
              "landcover": 0,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.582887411117554, 55.76360597204245],
                  [37.58296251296997, 55.763310200272585],
                  [37.58347749710083, 55.763267946979425],
                  [37.58331656455994, 55.763720658451604]]]),
            {
              "landcover": 0,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.57673978805542, 55.76202447242362],
                  [37.57693290710449, 55.76141479322694],
                  [37.577844858169556, 55.76133028248703],
                  [37.57805943489075, 55.761945999398165]]]),
            {
              "landcover": 0,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.577372789382935, 55.75895787055333],
                  [37.57769465446472, 55.75896390740807],
                  [37.57769465446472, 55.75922349127812],
                  [37.57750153541565, 55.75930196978239]]]),
            {
              "landcover": 0,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.57790923118591, 55.76699209711532],
                  [37.57756590843201, 55.76621953119271],
                  [37.577834129333496, 55.76611088788202],
                  [37.57843494415283, 55.76702831076734]]]),
            {
              "landcover": 0,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.58867025375366, 55.65302086885938],
                  [37.58952856063843, 55.653045081826896],
                  [37.58991479873657, 55.65373514510696],
                  [37.589378356933594, 55.65388042003723]]]),
            {
              "landcover": 0,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.58474349975586, 55.65358986963766],
                  [37.585623264312744, 55.65342038090886],
                  [37.58590221405029, 55.6547036344601],
                  [37.5852370262146, 55.65477627019581]]]),
            {
              "landcover": 0,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.58480787277222, 55.64930400078541],
                  [37.58592367172241, 55.649376646538606],
                  [37.585387229919434, 55.65105956876169],
                  [37.58399248123169, 55.65090217622406]]]),
            {
              "landcover": 0,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.58789777755737, 55.64751202954443],
                  [37.58721113204956, 55.646930832072314],
                  [37.588627338409424, 55.64677342293921]]]),
            {
              "landcover": 0,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[37.57294178009033, 55.64694294044094],
                  [37.57349967956543, 55.647076132248976],
                  [37.57199764251709, 55.64740305567544]]]),
            {
              "landcover": 0,
              "system:index": "32"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
//centering at Moscow
var roi_Moscow = ee.Geometry.Point(37.6378811, 55.764303);
var buffer_Moscow = roi_Moscow.buffer(15000);
Map.addLayer(buffer_Moscow,{}, "Moscow");

Map.setCenter(37.6378811, 55.764303, 10);

//Filtering to 2000, 2005, 2010, 2015 summer
var L7Filtered2015 = l7Raw.filterDate('2015-06-01','2015-08-31').filterBounds(buffer_Moscow);
var L7Filtered2010 = l7Raw.filterDate('2010-06-01','2010-08-31').filterBounds(buffer_Moscow);
var L7Filtered2005 = l7Raw.filterDate('2005-06-01','2005-08-31').filterBounds(buffer_Moscow);
var L7Filtered2000 = l7Raw.filterDate('2000-06-01','2000-08-31').filterBounds(buffer_Moscow);

Map.addLayer(L7Filtered2000,{},'Moscow 2000');
Map.addLayer(L7Filtered2015,{},'Moscow 2015');
//Creating Simple Composite for cleaner image

var l7Composite15= ee.Algorithms.Landsat.simpleComposite({
  collection: L7Filtered2015,
  asFloat: true
});

var l7Composite10= ee.Algorithms.Landsat.simpleComposite({
  collection: L7Filtered2010,
  asFloat: true
});

var l7Composite05= ee.Algorithms.Landsat.simpleComposite({
  collection: L7Filtered2005,
  asFloat: true
});

var l7Composite00= ee.Algorithms.Landsat.simpleComposite({
  collection: L7Filtered2000,
  asFloat: true
});

//Now calculate NDVI, NDWI, NDBI to see what's happeing, train classificator

//NDVI
var ndvi15 = l7Composite15.normalizedDifference(['B4', 'B3']).rename('NDVI');
var ndvi10 = l7Composite10.normalizedDifference(['B4', 'B3']).rename('NDVI');
var ndvi05 = l7Composite05.normalizedDifference(['B4', 'B3']).rename('NDVI');
var ndvi00 = l7Composite00.normalizedDifference(['B4', 'B3']).rename('NDVI');

//NDBI
var ndbi15 = l7Composite15.normalizedDifference(['B5', 'B4']).rename('NDBI');
var ndbi10 = l7Composite10.normalizedDifference(['B5', 'B4']).rename('NDBI');
var ndbi05 = l7Composite05.normalizedDifference(['B5', 'B4']).rename('NDBI');
var ndbi00 = l7Composite00.normalizedDifference(['B5', 'B4']).rename('NDBI');

//NDWI

var ndwi15 = l7Composite15.normalizedDifference(['B2', 'B4']).rename('NDWI');
var ndwi10 = l7Composite10.normalizedDifference(['B2', 'B4']).rename('NDWI');
var ndwi05 = l7Composite05.normalizedDifference(['B2', 'B4']).rename('NDWI');
var ndwi00 = l7Composite00.normalizedDifference(['B2', 'B4']).rename('NDWI');

var landcover_training = BU_training.merge(NBU_training);
var landcover_validation = BU_validation.merge(NBU_validation);


//SETTING BANDS
var bands = ['B1', 'B2', 'B3', 'B4', 'B5', 'B6_VCID_2', 'B7', 'NDVI','NDBI','NDWI'];

//Adding bands to composites
var input15 = l7Composite15.addBands(ndvi15).addBands(ndbi15).addBands(ndwi15);
var input10 = l7Composite10.addBands(ndvi10).addBands(ndbi10).addBands(ndwi10);
var input05 = l7Composite05.addBands(ndvi05).addBands(ndbi05).addBands(ndwi05);
var input00 = l7Composite00.addBands(ndvi00).addBands(ndbi00).addBands(ndwi00);

//Creating the training dataset

var training = input15.select(bands).sampleRegions({
collection: landcover_training,
properties: ['landcover'],
scale: 30
});

var validation = input15.select(bands).sampleRegions({
collection: landcover_validation,
properties: ['landcover'],
scale: 30
});

//Choosing classifier
var trained = ee.Classifier.randomForest({numberOfTrees: 20})
.train({
features: training,
classProperty: 'landcover',
inputProperties: bands
});

//Getting trained classifier
// var trained = classifier.train(training, 'landcover', bands);

//?????Do I put 'class' or 'landcover' in there???? Well, apparently landcover it is

//Classifying 2015,2010,2005,2000 with 2015 trained classifier

var classified2000 = input00.select(bands).classify(trained);
var classified2005 = input05.select(bands).classify(trained);
var classified2010 = input10.select(bands).classify(trained);
var classified2015 = input15.select(bands).classify(trained);

//Map.addLayer(classified2000)
var accuracyMoscow = validation.classify(trained);

Export.table.toDrive(accuracyMoscow);


//Mapping results

Map.addLayer(classified2015.mask(classified2015), {'min':0, 'max':1 , 'palette':'ff133f'},'BU 2015');
Map.addLayer(classified2010.mask(classified2010), {'min':0, 'max':1 , 'palette':'b119ff'},'BU 2010');
Map.addLayer(classified2005.mask(classified2005), {'min':0, 'max':1 , 'palette':'blue'},'BU 2005');
Map.addLayer(classified2000.mask(classified2000), {'min':0, 'max':1 , 'palette':'1dfff4'},'BU 2000');

// //Exporting to Assets
// Export.image.toAsset({ 
//   image: classified2015,
//   region: buffer_Moscow,
//   description: 'built-up areas, Moscow, 2015', assetId: 'BuiltUpAreasMoscow2015',
//   scale: 30});
  
//Exporting to Google Drive
Export.image.toDrive(
  {image: classified2015,
    description: 'BU Moscow,2015',
    fileNamePrefix: 'bu_moscow_2015',
    region: buffer_Moscow,
    scale: 30, 
    maxPixels: 1e9
  });
  
  Export.image.toDrive(
  {image: classified2010,
    description: 'BU Moscow,2010',
    fileNamePrefix: 'bu_moscow_2010',
    region: buffer_Moscow,
    scale: 30, 
    maxPixels: 1e9
  });
  
   Export.image.toDrive(
  {image: classified2005,
    description: 'BU Moscow,2005',
    fileNamePrefix: 'bu_moscow_2005',
    region: buffer_Moscow,
    scale: 30, 
    maxPixels: 1e9
  });
  
   Export.image.toDrive(
  {image: classified2000,
    description: 'BU Moscow,2000',
    fileNamePrefix: 'bu_moscow_2000',
    region: buffer_Moscow,
    scale: 30, 
    maxPixels: 1e9
  });
  
  
Map.addLayer(ndbi15,{'min':-0.5197, 'max':0.664},'NDBI 2015');
Map.addLayer(ndbi00,{'min':-0.5197, 'max':0.664},'NDBI 2000');

// //Calculate a confusion matrix
// var accuracyMatrix = trained.confusionMatrix();
// print('Resubstitution error matrix: ', accuracyMatrix);

// //Estimate the overall accuracy rate
// var overallAccuracy = accuracyMatrix.accuracy();
// print('Training overall accuracy: ', overallAccuracy);

//Why is my classifier 100% correct???!!!!


//How big is urban area??? And it's not working...
//2015 Area
var urban_Moscow2015masked = classified2015.mask(classified2015);
var urban_Moscow2015 = urban_Moscow2015masked.clip(buffer_Moscow);

var urbanLandUseArea= urban_Moscow2015.multiply(ee.Image.pixelArea());

var stats = urbanLandUseArea.reduceRegion(
{
'reducer': ee.Reducer.sum(),
'scale': 30,
'geometry': buffer_Moscow,
'maxPixels': 1e9
});
print(stats);

print('urban area: ' + stats.getInfo() + ' square meters');

//2010 Area
var urban_Moscow2010masked = classified2010.mask(classified2010);
var urban_Moscow2010 = urban_Moscow2010masked.clip(buffer_Moscow);

var urbanLandUseArea= urban_Moscow2010.multiply(ee.Image.pixelArea());

var stats2010 = urbanLandUseArea.reduceRegion(
{
'reducer': ee.Reducer.sum(),
'scale': 30,
'geometry': buffer_Moscow,
'maxPixels': 1e9
});
print(stats2010);

print('urban area: ' + stats2010.getInfo() + ' square meters');

//2005 Area
var urban_Moscow2005masked = classified2005.mask(classified2005);
var urban_Moscow2005 = urban_Moscow2005masked.clip(buffer_Moscow);

var urbanLandUseArea= urban_Moscow2005.multiply(ee.Image.pixelArea());

var stats2005 = urbanLandUseArea.reduceRegion(
{
'reducer': ee.Reducer.sum(),
'scale': 30,
'geometry': buffer_Moscow,
'maxPixels': 1e9
});
print(stats2005);

print('urban area: ' + stats2005.getInfo() + ' square meters');

//2000 Area
var urban_Moscow2000masked = classified2000.mask(classified2000);
var urban_Moscow2000 = urban_Moscow2000masked.clip(buffer_Moscow);

var urbanLandUseArea= urban_Moscow2000.multiply(ee.Image.pixelArea());

var stats2000 = urbanLandUseArea.reduceRegion(
{
'reducer': ee.Reducer.sum(),
'scale': 30,
'geometry': buffer_Moscow,
'maxPixels': 1e9
});
print(stats2000);

print('urban area: ' + stats2000.getInfo() + ' square meters');


Map.addLayer(L7Filtered2015,{'bands':['B3', 'B2', 'B1']},'Moscow summer 20015');


